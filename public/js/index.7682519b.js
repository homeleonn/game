(function(t){function e(e){for(var c,i,a=e[0],o=e[1],u=e[2],l=0,d=[];l<a.length;l++)i=a[l],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&d.push(s[i][0]),s[i]=0;for(c in o)Object.prototype.hasOwnProperty.call(o,c)&&(t[c]=o[c]);b&&b(e);while(d.length)d.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],c=!0,i=1;i<n.length;i++){var a=n[i];0!==s[a]&&(c=!1)}c&&(r.splice(e--,1),t=o(o.s=n[0]))}return t}var c={},i={index:0},s={index:0},r=[];function a(t){return o.p+"js/"+({}[t]||t)+"."+{"chunk-d296e478":"79b8faf0"}[t]+".js"}function o(e){if(c[e])return c[e].exports;var n=c[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(t){var e=[],n={"chunk-d296e478":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise((function(e,n){for(var c="css/"+({}[t]||t)+"."+{"chunk-d296e478":"ef713ffb"}[t]+".css",s=o.p+c,r=document.getElementsByTagName("link"),a=0;a<r.length;a++){var u=r[a],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===c||l===s))return e()}var d=document.getElementsByTagName("style");for(a=0;a<d.length;a++){u=d[a],l=u.getAttribute("data-href");if(l===c||l===s)return e()}var b=document.createElement("link");b.rel="stylesheet",b.type="text/css",b.onload=e,b.onerror=function(e){var c=e&&e.target&&e.target.src||s,r=new Error("Loading CSS chunk "+t+" failed.\n("+c+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=c,delete i[t],b.parentNode.removeChild(b),n(r)},b.href=s;var m=document.getElementsByTagName("head")[0];m.appendChild(b)})).then((function(){i[t]=0})));var c=s[t];if(0!==c)if(c)e.push(c[2]);else{var r=new Promise((function(e,n){c=s[t]=[e,n]}));e.push(c[2]=r);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.src=a(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(b);var n=s[t];if(0!==n){if(n){var c=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+c+": "+i+")",d.name="ChunkLoadError",d.type=c,d.request=i,n[1](d)}s[t]=void 0}};var b=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},o.m=t,o.c=c,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var c in t)o.d(n,c,function(e){return t[e]}.bind(null,c));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/",o.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var b=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("1112")},"040e":function(t,e,n){"use strict";n("0aff")},"09ef":function(t,e,n){},"0af2":function(t,e,n){},"0aff":function(t,e,n){},"0cdb":function(t,e,n){},"0d30":function(t,e,n){"use strict";n("5f1f")},1112:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var c=n("f2bf"),i=n("1da1"),s=(n("96cf"),n("4de4"),n("c740"),n("d3b7"),n("5502")),r=Object(s["a"])({state:{user:{},location:{},locationUsers:[],closestLocations:{},activeLocation:!1,userItems:null,activeItem:null,dbLog:[],needRegeneration:!1,fightStats:null,fightLog:[],csrf:"",modal:null,time:0,host:0},mutations:{SET_TIME:function(t,e){t.time=e},SET_MODAL:function(t,e){t.modal=e},SET_FIGHTSTATS:function(t,e){t.fightStats=e},ADD_FIGHT_LOG:function(t,e){t.fightLog.push(e)},CLEAR_FIGHT_LOG:function(t){t.fightLog=[]},SET_USER:function(t,e){Object.assign(t.user,toNums(e))},UPDATE_USER:function(t,e){Object.assign(t.user,toNums(e))},SET_USER_ITEMS:function(t,e){t.userItems=e},SET_USER_LOCATION:function(t,e){t.user.location=e},SET_LOCATION:function(t,e){t.location=e},SET_LOCATION_USERS:function(t,e){t.locationUsers=e},ADD_LOCATION_USER:function(t,e){t.locationUsers.push(e)},REMOVE_LOCATION_USER:function(t,e){t.locationUsers=t.locationUsers.filter((function(t){return t.id!=e}))},SET_CLOSEST_LOCATIONS:function(t,e){t.closestLocations=e},SET_ACTIVE_LOCATION:function(t,e){t.activeLocation=e},SET_DB_LOG:function(t,e){t.dbLog=e},SET_CSRF:function(t,e){t.csrf=e},SET_ACTIVE_ITEM:function(t,e){t.activeItem=e},REMOVE_ITEM:function(t,e){delete t.userItems[e]},PUT_ON_ITEM:function(t,e){var n=t.userItems.findIndex((function(t){return t.id==e}));t.userItems[n].loc="WEARING"},TAKE_OFF_ITEM:function(t,e){var n=t.userItems.findIndex((function(t){return t.id==e}));t.userItems[n].loc="INVENTORY"}},getters:{user:function(t){return t.user},userItems:function(t){return t.userItems},activeItem:function(t){return t.activeItem},csrf:function(t){return t.csrf},location:function(t){return t.location},locationUsers:function(t){return t.locationUsers},closestLocations:function(t){return t.closestLocations},activeLocation:function(t){return t.activeLocation},dbLog:function(t){return t.dbLog}},actions:{init:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,a("/init",(function(t,e){e("SET_USER",t.user)}),n);case 3:case"end":return e.stop()}}),e)})))()},changeLocation:function(t,e){return Object(i["a"])(regeneratorRuntime.mark((function n(){var c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return c=t.commit,n.next=3,a("/change-location/"+e,(function(t,n){n("SET_USER_LOCATION",e)}),c);case 3:case"end":return n.stop()}}),n)})))()}}});function a(t){return o.apply(this,arguments)}function o(){return o=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,c,i,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]&&s[1],c=s.length>2?s[2]:void 0,t.prev=2,t.next=5,fetch(e,{headers:{"Content-Type":"application/json"}});case 5:return i=t.sent,t.next=8,i.json();case 8:return i=t.sent,n&&n(i,c),c("SET_LOCATION",i.location),c("SET_CLOSEST_LOCATIONS",i.closestLocations),i.db&&c("SET_DB_LOG",i.db),t.abrupt("return",i);case 16:t.prev=16,t.t0=t["catch"](2),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[2,16]])}))),o.apply(this,arguments)}var u={class:"main"};function l(t,e,n,i,s,r){var a=Object(c["r"])("game-header"),o=Object(c["r"])("main-modal"),l=Object(c["r"])("user-supplies"),d=Object(c["r"])("npc-view"),b=Object(c["r"])("game-footer");return s.apiReady?(Object(c["k"])(),Object(c["d"])(c["a"],{key:0},[Object(c["g"])(a,{onSetCurComp:r.setCurComp},null,8,["onSetCurComp"]),Object(c["g"])("div",u,[Object(c["g"])(o),Object(c["g"])(l),s.npc?(Object(c["k"])(),Object(c["d"])(d,{key:0,npc:s.npc},null,8,["npc"])):(Object(c["k"])(),Object(c["d"])(Object(c["s"])(s.currentMainComponent),{key:1,onChloc:r.changeLocation,onSetCurComp:r.setCurComp},null,8,["onChloc","onSetCurComp"]))]),Object(c["g"])(b,{onSendMessage:r.sendMessage,onSetCurComp:r.setCurComp},null,8,["onSendMessage","onSetCurComp"])],64)):Object(c["e"])("",!0)}var d=n("53ca"),b=n("5530"),m=(n("3ca3"),n("ddb0"),n("2b3d"),n("99af"),n("b64b"),n("159b"),n("b0c0"),{id:"dblog"}),O=Object(c["g"])("hr",null,null,-1);function f(t,e,n,i,s,r){var a=Object(c["r"])("user-short-info");return Object(c["k"])(),Object(c["d"])("header",null,[Object(c["g"])("div",{class:"avatar",style:{backgroundImage:"url(img/images/".concat(t.user.sex,".png)")},title:"Персонаж",onClick:e[1]||(e[1]=function(t){return r.getUserInfo()})},null,4),Object(c["g"])(a,{user:t.user,hpLineStyle:s.hpLineStyle},null,8,["user","hpLineStyle"]),Object(c["g"])("div",{class:["top-panel flex",{disabled:t.user.fight}]},[Object(c["g"])("div",null,[Object(c["g"])("img",{src:"img/other/pack.jpg",title:"Рюкзак",onClick:e[2]||(e[2]=function(e){return t.$emit("setCurComp","UserBackpack")})})]),Object(c["g"])("div",null,[Object(c["g"])("img",{src:"img/other/location.jpg",title:"Локация",onClick:e[3]||(e[3]=function(e){return t.$emit("setCurComp","LocationWrapper")})})]),Object(c["g"])("div",null,[Object(c["g"])("img",{src:"img/other/fight.jpg",title:"Бои",onClick:e[4]||(e[4]=function(e){return t.$emit("setCurComp","TheHunting")})})]),Object(c["g"])("div",null,[Object(c["g"])("img",{src:"img/other/quest.jpg",title:"Квесты",onClick:e[5]||(e[5]=function(e){return t.$emit("setCurComp","QuestList")})})])],2),Object(c["g"])("div",m,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t.dbLog,(function(t){return Object(c["k"])(),Object(c["d"])("div",{key:t},[Object(c["f"])(Object(c["t"])(t.query)+"; t::"+Object(c["t"])(t.time)+"; b::"+Object(c["t"])(t.bindings)+"; ",1),O])})),128))])])}var g={class:"info"},j={key:0,class:"tendency"},h={key:1,class:"clan"},v={class:"login"},p=Object(c["g"])("span",{class:"icon-ok"},null,-1),k={class:"hp-wrapper"},y={class:"hp-back"},I={class:"hp"},T={key:0,class:"icon-spin3 active"};function E(t,e,n,i,s,r){var a;return Object(c["k"])(),Object(c["d"])("div",{class:["info-wrapper",{shrink:n.shrink}]},[Object(c["g"])("div",g,[n.user.tendency_name?(Object(c["k"])(),Object(c["d"])("div",j,[Object(c["g"])("img",{src:"/img/tendencies/".concat(n.user.tendency_img),title:n.user.tendency_name},null,8,["src","title"])])):Object(c["e"])("",!0),n.user.clan_name?(Object(c["k"])(),Object(c["d"])("div",h,[Object(c["g"])("img",{src:"/img/clans/".concat(n.user.clan_img),title:n.user.clan_name},null,8,["src","title"])])):Object(c["e"])("",!0),Object(c["g"])("div",v,[Object(c["f"])(Object(c["t"])(null!==(a=n.user.login)&&void 0!==a?a:n.user.name)+"["+Object(c["t"])(n.user.level)+"]",1),p])]),Object(c["g"])("div",k,[Object(c["g"])("div",y,[Object(c["g"])("div",{class:"hp-line",style:r.hpLineStyle},null,4)]),Object(c["g"])("div",I,Object(c["t"])(r.hp),1),n.isRegenerating?(Object(c["k"])(),Object(c["d"])("span",T)):Object(c["e"])("",!0)])],2)}var w={props:{user:Object,isRegenerating:{default:function(){return!1}},shrink:{type:Boolean,default:function(){return!1}}},computed:{hp:function(){return(this.user.curhp<=0?0:this.user.curhp)+" / "+this.user.maxhp},hpLineStyle:function(){return setHpLineStyle(this.user.curhp,this.user.maxhp)}}};n("0d30");w.render=E;var S=w,C="http://framework.loc/wsToken",L="192.168.0.101",A="8090",R="prod",x={name:"GameHeader",components:{UserShortInfo:S},data:function(){return{hpLineStyle:{},isRegenerating:!1,maxHpChanged:!1,HpRestore:null}},methods:{stopRegen:function(){this.isRegenerating=!1},regeneration:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,c=arguments.length>2?arguments[2]:void 0,i=function(e,n,c){return function(){t.user.fight&&t.stopRegen(),t.isRegenerating=!0,n=t.user.maxhp;var i=getTimeSeconds();c||(c=i),e+=(i-c)*o,c=i,e>=n&&(e=n),t.user.curhp=Math.floor(+e),t.user.last_restore=i,t.hpLineStyle=setHpLineStyle(e,n),e>=n&&t.stopRegen()}};if(this.hpLineStyle=setHpLineStyle(e,n),e=this.user.curhp,n=this.user.maxhp,e>=n)return this.user.curhp=n,void(this.hpLineStyle=setHpLineStyle(e,n));if(this.isRegenerating)return this.HpRestore();var s=1,r=1,a=.5,o=n/(r/s)/60;if(this.HpRestore=i(e,n,c),this.HpRestore(),this.isRegenerating)var u=setInterval((function(){t.HpRestore(),t.isRegenerating||clearInterval(u)}),1e3/a)},getUserInfo:function(){window.open("".concat(this.host,"/user/").concat(this.user.id,"/info"),"_blank").focus()}},computed:Object(b["a"])(Object(b["a"])({},Object(s["b"])(["user","dbLog"])),Object(s["d"])(["host"])),mounted:function(){var t=this;this.regeneration(),this.$store.watch((function(){return t.$store.state.user.curhp}),(function(){t.regeneration()})),this.$store.watch((function(){return t.$store.state.user.maxhp}),(function(){t.regeneration()}))}};n("dee4");x.render=f;var M=x,N={ref:"footer"},U={id:"chat"},$={class:"flex"},F={class:"messages-wrapper"},H={id:"messages",ref:"messages"},q={class:"fight-log"},D={id:"chat-loc"},V={id:"location-caption"},B={class:"name"},P=Object(c["f"])(" ("),Q={class:"count"},G=Object(c["f"])(") "),W={id:"bottom-panel"},K={id:"time"},z={id:"message-wrap"},J=Object(c["g"])("div",null,[Object(c["g"])("img",{src:"img/chat/chat_clear.gif",title:"очистить чат",id:"chat-clear"})],-1),Y=Object(c["g"])("div",null,[Object(c["g"])("img",{src:"img/chat/chat.ico",title:"Смайлы"})],-1),X={action:"/logout",method:"get",id:"logout"},Z=Object(c["g"])("button",{name:"logout"},"Выход",-1);function tt(t,e,n,i,s,r){var a=Object(c["r"])("user-list");return Object(c["k"])(),Object(c["d"])("footer",N,[Object(c["g"])("div",U,[Object(c["g"])("div",$,[Object(c["g"])("div",F,[Object(c["g"])("div",{class:["resizer",{offset:s.isFightLogVisible}]},[Object(c["g"])("div",{class:"up",onClick:e[1]||(e[1]=function(t){return r.resize(!0)})},"▲"),Object(c["g"])("div",{class:"down",onClick:e[2]||(e[2]=function(t){return r.resize(!1)})},"▼")],2),Object(c["g"])("div",H,null,512)]),Object(c["y"])(Object(c["g"])("div",q,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t.$store.state.fightLog,(function(t,e){return Object(c["k"])(),Object(c["d"])("div",{key:t,innerHTML:e+1+". "+t},null,8,["innerHTML"])})),128))],512),[[c["v"],s.isFightLogVisible]]),Object(c["g"])("button",{class:["fight-log-toggle btn",{active:s.isFightLogVisible}],onClick:e[3]||(e[3]=function(t){return s.isFightLogVisible=!s.isFightLogVisible})},"Лог боя",2),Object(c["g"])("div",D,[Object(c["g"])("div",V,[Object(c["g"])("span",B,Object(c["t"])(t.location.name),1),P,Object(c["g"])("span",Q,Object(c["t"])(t.locationUsers.length),1),G]),Object(c["g"])(a,{users:t.locationUsers},null,8,["users"])])]),Object(c["g"])("div",W,[Object(c["g"])("div",K,Object(c["t"])(s.clock),1),Object(c["g"])("form",{id:"sendmessage-form",class:"flex",onSubmit:e[6]||(e[6]=Object(c["z"])((function(){}),["prevent"]))},[Object(c["g"])("div",z,[Object(c["y"])(Object(c["g"])("input",{class:"message","onUpdate:modelValue":e[4]||(e[4]=function(t){return s.message=t}),id:"message",type:"text",name:"message",size:"80",autocomplete:"off"},null,512),[[c["u"],s.message]])]),Object(c["g"])("div",null,[Object(c["g"])("input",{type:"image",src:"img/chat/message_send.png",title:"Отправить",id:"sendmessage",onClick:e[5]||(e[5]=function(){return r.send&&r.send.apply(r,arguments)})})])],32),J,Y,Object(c["g"])("form",X,[Object(c["g"])("input",{type:"hidden",name:"_token",value:t.csrf},null,8,["value"]),Z])])])],512)}var et={id:"loc-users"},nt=Object(c["g"])("div",null,[Object(c["g"])("img",{src:"img/chat/prv_but.png",class:"prv-msg",title:"Отправить приватное сообщение"})],-1),ct={key:0,class:"tendency"},it={key:1,class:"clan"},st={class:"login-wrapper"},rt={class:"login"},at={class:"level"},ot=Object(c["g"])("img",{src:"img/user/get_info.gif",class:"get-info",title:"Информация о персонаже"},null,-1);function ut(t,e,n,i,s,r){return Object(c["k"])(),Object(c["d"])("div",et,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(n.users,(function(e){return Object(c["k"])(),Object(c["d"])("div",{key:e,class:"user",id:"user-".concat(e.id)},[nt,e.tendency_name?(Object(c["k"])(),Object(c["d"])("div",ct,[Object(c["g"])("img",{src:"/img/tendencies/".concat(e.tendency_img),title:e.tendency_name},null,8,["src","title"])])):Object(c["e"])("",!0),e.clan_name?(Object(c["k"])(),Object(c["d"])("div",it,[Object(c["g"])("img",{src:"/img/clans/".concat(e.clan_img),title:e.clan_name},null,8,["src","title"])])):Object(c["e"])("",!0),Object(c["g"])("div",st,[Object(c["g"])("span",rt,Object(c["t"])(e.login),1),Object(c["g"])("span",at,"["+Object(c["t"])(e.level)+"]",1)]),Object(c["g"])("div",null,[Object(c["g"])("a",{href:"".concat(t.$store.state.host,"/user/").concat(e.id,"/info"),target:"_blank"},[ot],8,["href"])])],8,["id"])})),128))])}var lt={props:{users:Array},mounted:function(){}};lt.render=ut;var dt,bt,mt,Ot=lt,ft={name:"GameFooter",emits:["setCurComp"],inject:["api"],data:function(){return{message:"",isFightLogVisible:!1,clock:date("H:i")}},computed:Object(b["a"])({},Object(s["b"])(["csrf","location","locationUsers","user"])),methods:{send:function(){this.$emit("sendMessage",this.message),this.message=""},doAction:function(){this.api.doAction("admin_user",{userId:1,props:{curhp:18}})},resize:function(t){var e=50,n=dt.css("height",!1);n+=t?e:-e,dt.css("height",n+"px"),bt.css("height",n-70+"px"),mt.css("margin-bottom",n+"px")},startClock:function(){var t=this;setInterval((function(){t.clock=date("H:i")}),1e4)}},created:function(){},mounted:function(){var t=this;this.startClock(),this.user.fight&&(this.isFightLogVisible=!0),this.$store.watch((function(){return t.$store.state.user.fight}),(function(e){t.isFightLogVisible=e})),dt=_("footer");var e=dt.css("height",!1);mt=_(".main"),bt=_("#loc-users"),bt.css("height",e+"px"),mt.css("margin-bottom",e+"px");var n=document.querySelector(".fight-log");this.$store.watch((function(t){return t.fightLog}),(function(){setTimeout((function(){n.scroll(0,n.scrollHeight+100)}),0)}),{deep:!0})},components:{UserList:Ot}};n("ac9d");ft.render=tt;var gt=ft,jt={id:"location-wrapper"},ht={class:"location"},vt={class:"name"},pt={class:"svg-wrapper"},kt={ref:"svg"},yt={class:"location-select"},It={class:"location-block locations"},Tt=Object(c["g"])("div",{class:"title"},"Локации",-1),_t={class:"list"},Et={class:"location-block objects"},wt=Object(c["g"])("div",{class:"title"},"Объекты",-1),St={class:"list"},Ct={class:"location-block characters"},Lt=Object(c["g"])("div",{class:"title"},"Персонажи",-1),At={class:"list"},Rt={class:"location-pass"},xt=Object(c["g"])("div",{class:"title"},null,-1),Mt={class:"progressbar"},Nt={key:0,class:"center"},Ut={class:"center"},$t={key:0},Ft={key:1},Ht=Object(c["g"])("span",{class:"loader"},null,-1);function qt(t,e,n,i,s,r){var a=Object(c["r"])("location-link");return Object(c["k"])(),Object(c["d"])("div",jt,[Object(c["g"])("div",ht,[Object(c["g"])("div",vt,Object(c["t"])(t.location.name),1),Object(c["g"])("div",pt,[(Object(c["k"])(),Object(c["d"])("svg",kt,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t.location.loc_coords,(function(n,i){return Object(c["k"])(),Object(c["d"])("polygon",{key:i,class:["loc-".concat(i),{active:t.activeLocation==i}],points:n,onMouseenter:function(e){return t.SET_ACTIVE_LOCATION(i)},onMouseleave:e[1]||(e[1]=function(e){return t.SET_ACTIVE_LOCATION(!1)}),onClick:function(e){return t.$emit("chloc",i)}},null,42,["points","onMouseenter","onClick"])})),128))],512))]),Object(c["g"])("img",{src:r.locImg,class:"map"},null,8,["src"])]),Object(c["g"])("div",yt,[Object(c["g"])("div",It,[Tt,Object(c["g"])("div",_t,[Object(c["g"])(a,{closestLocations:t.closestLocations,type:"location",onChloc:e[2]||(e[2]=function(e){return t.$emit("chloc",e)}),disabled:r.progress},null,8,["closestLocations","disabled"])])]),Object(c["g"])("div",Et,[wt,Object(c["g"])("div",St,[Object(c["g"])(a,{closestLocations:t.closestLocations,type:"object",onChloc:e[3]||(e[3]=function(e){return t.$emit("chloc",e)}),disabled:r.progress},null,8,["closestLocations","disabled"])])]),Object(c["g"])("div",Ct,[Lt,Object(c["g"])("div",At,[Object(c["g"])(a,{closestLocations:t.closestLocations,type:"character",disabled:r.progress},null,8,["closestLocations","disabled"])])]),Object(c["g"])("div",Rt,[xt,Object(c["g"])("div",Mt,[Object(c["g"])("div",{class:"progress",style:{width:r.progress+"%"}},null,4)]),r.progress?(Object(c["k"])(),Object(c["d"])("div",Nt,Object(c["t"])(r.timerBoard),1)):Object(c["e"])("",!0),Object(c["g"])("div",Ut,[r.progress?(Object(c["k"])(),Object(c["d"])("div",Ft,"До перехода осталось...")):(Object(c["k"])(),Object(c["d"])("div",$t,"Переход возможен"))])])]),Ht])}var Dt=Object(c["A"])("data-v-5159c35c"),Vt=Dt((function(t,e,n,i,s,r){return Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(n.closestLocations[n.type],(function(i,s){return Object(c["k"])(),Object(c["d"])("div",{key:"link-loc-"+s,class:["link","loc-"+s,{active:t.activeLocation==s,disabled:n.disabled&&"character"!=n.type}],onMouseenter:function(e){return t.SET_ACTIVE_LOCATION(s)},onMouseleave:e[1]||(e[1]=function(e){return t.SET_ACTIVE_LOCATION(!1)}),onClick:function(t){return r.test(s)}},Object(c["t"])(i),43,["onMouseenter","onClick"])})),128)})),Bt={name:"LocationLink",props:["closestLocations","type","disabled"],emits:["chloc"],inject:["api","talkToNpc"],methods:Object(b["a"])(Object(b["a"])({},Object(s["c"])(["SET_ACTIVE_LOCATION"])),{},{test:function(t){if("character"==this.type)return this.talkToNpc(t);this.disabled||this.$emit("chloc",t)}}),computed:Object(b["a"])({},Object(s["b"])(["activeLocation"])),mounted:function(){}};n("8e06");Bt.render=Vt,Bt.__scopeId="data-v-5159c35c";var Pt=Bt,Qt={name:"location-wrapper",components:{LocationLink:Pt},emits:["chloc"],inject:["apiSubscribe"],data:function(){return{fullTransitionTime:0}},methods:Object(b["a"])(Object(b["a"])({},Object(s["c"])(["SET_ACTIVE_LOCATION"])),{},{getFullTimeTransition:function(){return this.user.trans_timeout-this.user.trans_time}}),computed:Object(b["a"])(Object(b["a"])({},Object(s["b"])(["location","closestLocations","activeLocation","user"])),{},{locImg:function(){return null==this.location.image?"img/other/no-image.png":"img/locations/"+this.location.image},progress:function(){if(!this.user.trans_timeout||this.time>this.user.trans_timeout)return 0;var t=this.user.trans_timeout-this.user.trans_time,e=this.time-this.user.trans_time,n=100-e/t*100;return n>100?100:n},timerBoard:function(){return timer(this.user.trans_timeout-this.time)},time:function(){return this.$store.state.time}}),mounted:function(){this.apiSubscribe({})},beforeUnmount:function(){clearInterval(this.timer)}};n("9ab1");Qt.render=qt;var Gt=Qt,Wt={class:"pack"},Kt={class:"row"};function zt(t,e,n,i,s,r){var a=Object(c["r"])("user-form"),o=Object(c["r"])("item-lists"),u=Object(c["r"])("item-info");return Object(c["k"])(),Object(c["d"])("div",Wt,[Object(c["g"])("div",Kt,[Object(c["g"])(a,{items:r.wearedItems,user:t.$store.getters.user,onTakeoffItem:r.takeoffItem},null,8,["items","user","onTakeoffItem"]),Object(c["g"])(o,{items:r.packedItems,onRemoveItem:r.removeItem,onWearItem:r.wearItem},null,8,["items","onRemoveItem","onWearItem"])]),Object(c["g"])(u)])}var Jt=n("3835"),Yt={class:"backpack-wrapper col-md-7"},Xt={class:"tabs"},Zt={class:"backpack-items"},te={key:0},ee=Object(c["g"])("small",{class:"center"},"Вещи",-1),ne=Object(c["g"])("small",{class:"center"},"Расходные материалы",-1),ce={key:1};function ie(t,e,n,i,s,r){var a=Object(c["r"])("item-list");return Object(c["k"])(),Object(c["d"])("div",Yt,[Object(c["g"])("div",Xt,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t.$options.tabs,(function(t,e){return Object(c["k"])(),Object(c["d"])("button",{key:t,class:["tab-button",{active:s.currentTab===e}],onClick:function(t){return s.currentTab=e}},Object(c["t"])(t),11,["onClick"])})),128))]),Object(c["g"])("div",Zt,["main"===s.currentTab?(Object(c["k"])(),Object(c["d"])("div",te,[Object(c["g"])(a,{items:s.itemsByType.armors,usage:"Надеть",onRemoveItem:e[1]||(e[1]=function(e){return t.$emit("removeItem",e)}),onWearItem:e[2]||(e[2]=function(e){return t.$emit("wearItem",e)})},{default:Object(c["x"])((function(){return[ee]})),_:1},8,["items"]),Object(c["g"])(a,{items:s.itemsByType.supplies,usage:"Исп-ть",onRemoveItem:e[3]||(e[3]=function(e){return t.$emit("removeItem",e)}),onWearItem:e[4]||(e[4]=function(e){return t.$emit("wearItem",e)})},{default:Object(c["x"])((function(){return[ne]})),_:1},8,["items"])])):(Object(c["k"])(),Object(c["d"])("div",ce,[Object(c["g"])(a,{items:s.itemsByType[s.currentTab],onRemoveItem:e[5]||(e[5]=function(e){return t.$emit("removeItem",e)})},null,8,["items"])]))])])}n("4fad"),n("caad"),n("2532");var se={key:0,class:"center"};function re(t,e,n,i,s,r){var a=Object(c["r"])("pack-item");return Object(c["k"])(),Object(c["d"])(c["a"],null,[Object(c["q"])(t.$slots,"default"),n.items.length?Object(c["e"])("",!0):(Object(c["k"])(),Object(c["d"])("h5",se,"Пусто")),(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(n.items,(function(i){return Object(c["k"])(),Object(c["d"])("div",{key:i,class:"item"},[Object(c["g"])(a,{item:i,usage:n.usage,onRemoveItem:e[1]||(e[1]=function(e){return t.$emit("removeItem",e)}),onWearItem:e[2]||(e[2]=function(e){return t.$emit("wearItem",e)})},null,8,["item","usage"])])})),128))],64)}var ae={class:"pack-item"},oe={key:2,class:"action bl"},ue={class:"pack-item__title"},le={key:0,class:"action bl"};function de(t,e,n,i,s,r){return Object(c["k"])(),Object(c["d"])("div",ae,[n.item.id?(Object(c["k"])(),Object(c["d"])(c["a"],{key:0},[Object(c["g"])("img",{src:n.item.image,onMouseenter:e[1]||(e[1]=function(t){return r.setActive(n.item)}),onMouseleave:e[2]||(e[2]=function(t){return r.setActive(!1)})},null,40,["src"]),n.usage&&t.user.level>=n.item.need_level?(Object(c["k"])(),Object(c["d"])("div",{key:0,class:"action tl",onMouseenter:e[3]||(e[3]=function(t){return s.itemTitle=n.usage}),onClick:e[4]||(e[4]=function(t){return r.use(n.item,n.usage)})}," н ",32)):Object(c["e"])("",!0),Object(c["g"])("div",{class:"action tr",onMouseenter:e[5]||(e[5]=function(t){return s.itemTitle="Информация"}),onClick:e[6]||(e[6]=function(){return t.info&&t.info.apply(t,arguments)})}," i ",32),"Снять"!=n.usage?(Object(c["k"])(),Object(c["d"])("div",{key:1,class:"action br",onMouseenter:e[7]||(e[7]=function(t){return s.itemTitle="Выбросить"}),onClick:e[8]||(e[8]=function(t){return r.remove(n.item)})}," x ",32)):Object(c["e"])("",!0),r.count?(Object(c["k"])(),Object(c["d"])("div",oe,Object(c["t"])(r.count),1)):Object(c["e"])("",!0),Object(c["g"])("div",ue,Object(c["t"])(s.itemTitle),1)],64)):(Object(c["k"])(),Object(c["d"])(c["a"],{key:1},[Object(c["g"])("img",{src:n.item.image},null,8,["src"]),r.count?(Object(c["k"])(),Object(c["d"])("div",le,Object(c["t"])(r.count),1)):Object(c["e"])("",!0)],64))])}var be={props:{item:Object,onlyShow:{type:Boolean,default:!1},usage:{type:String,validator:function(t){return[null,"Надеть","Снять","Исп-ть"].includes(t)},default:null}},emits:["removeItem","wearItem","takeoffItem"],data:function(){return{itemTitle:null}},computed:Object(b["a"])(Object(b["a"])({},Object(s["b"])(["user"])),{},{count:function(){return this.item.count>1?this.item.count:""}}),methods:Object(b["a"])(Object(b["a"])({},Object(s["c"])(["SET_ACTIVE_ITEM"])),{},{setActive:function(t){this.SET_ACTIVE_ITEM(t)},remove:function(t){if(!confirm("Точно выбрость?"))return!1;this.$emit("removeItem",t)},use:function(t,e){this.$emit("Надеть"===e||"Исп-ть"===e?"wearItem":"takeoffItem",t)}})};n("dfbc");be.render=de;var me=be,Oe={components:{PackItem:me},props:{items:Object,usage:String},emits:["removeItem","wearItem"]};Oe.render=re;var fe=Oe,ge={props:{items:Array},emits:["removeItem","wearItem"],components:{ItemList:fe},data:function(){return{itemIdCounter:100,activeItem:!1,currentTab:"main",itemsByType:null}},tabs:{main:"Вещи",others:"Разное",quests:"Квесты",gifts:"Подарки"},itemTypes:{armors:["armor","weapon"],supplies:["potion","scroll"],others:["fish","plant","trash"],quests:["quest"],gifts:["gift"]},created:function(){this.resetItemsByType()},computed:{},watch:{items:function(t){var e=this;this.resetItemsByType(),t.forEach((function(t){for(var n=0,c=Object.entries(e.$options.itemTypes);n<c.length;n++){var i=Object(Jt["a"])(c[n],2),s=i[0],r=i[1];r.includes(t.item_type)&&e.itemsByType[s].push(t)}}))}},methods:{resetItemsByType:function(){this.itemsByType={armors:[],supplies:[],others:[],quests:[],gifts:[]}}}};n("d307");ge.render=ie;var je=ge,he={class:"flex"},ve={key:0},pe={class:"user-form"},ke={class:"row"},ye={class:"user-form__left"},Ie={class:"user-form__image"},Te={class:"user-form__right"};function _e(t,e,n,i,s,r){var a=Object(c["r"])("user-short-info"),o=Object(c["r"])("pack-item"),u=Object(c["r"])("user-info");return Object(c["k"])(),Object(c["d"])("div",{class:["user-form-wrapper col-md-5",{fight:n.isFight}]},[Object(c["g"])("div",he,[n.isFight?(Object(c["k"])(),Object(c["d"])("div",ve,[Object(c["g"])(a,{user:n.user},null,8,["user"])])):Object(c["e"])("",!0),Object(c["g"])("div",pe,[Object(c["g"])("div",ke,[Object(c["g"])("div",ye,[(Object(c["k"])(),Object(c["d"])(c["a"],null,Object(c["p"])(["head","rhand","chest"],(function(e,n){return Object(c["g"])("div",{class:"user-form__slot",key:n},[Object(c["g"])(o,{item:r.getSlot(e),usage:"Снять",onTakeoffItem:function(e){return t.$emit("takeoffItem",e)}},null,8,["item","onTakeoffItem"])])})),64))]),Object(c["g"])("div",Ie,[Object(c["g"])("img",{src:r.image},null,8,["src"])]),Object(c["g"])("div",Te,[(Object(c["k"])(),Object(c["d"])(c["a"],null,Object(c["p"])(["gloves","lhand","legs","feet"],(function(e,n){return Object(c["g"])("div",{class:"user-form__slot",key:n},[Object(c["g"])(o,{item:r.getSlot(e),usage:"Снять",onTakeoffItem:function(e){return t.$emit("takeoffItem",e)}},null,8,["item","onTakeoffItem"])])})),64))])])]),Object(c["g"])(u,{info:r.userInfo},null,8,["info"])])],2)}n("a434"),n("7db0"),n("d81d");function Ee(t,e,n,i,s,r){return Object(c["k"])(),Object(c["d"])("div",{class:["user-info col-md-4",n.classes]},[Object(c["g"])("table",null,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(n.info,(function(t){return Object(c["k"])(),Object(c["d"])("tr",{key:t},[Object(c["g"])("td",null,Object(c["t"])(t.k),1),Object(c["g"])("td",null,Object(c["t"])(t.v),1)])})),128))])],2)}var we={props:{info:{type:Array,required:!1,default:function(){return[]}},classes:{type:String,required:!1,default:function(){return""}}}};we.render=Ee;var Se=we,Ce={name:"имя",item_type:"Тип",body_part:"Часть тела",armor_type:"Тип брони",weight:"Вес",material:"Материал",need_level:"Уровень",weapon_type:"Тип оружия",min_damage:"Мин. урон",max_damage:"Макс. урон",power:"Сила",critical:"Интуиция",evasion:"Ловкость",stamina:"Выносливость",hp:"Жизнь",mf_crit:"Мф. крит",mf_acrit:"Мф. антикрит",mf_evas:"Мф. ловк",mf_aevas:"Мф. антиловк",def_head:"Защ. головы",def_chest:"Защ. груди",def_abs:"Защ. живота",def_crotch:"Защ. пояса",price:"Цена",stackable:"стыковки",sellable:"продажи",dropable:"выпадения",destroyable:"разрушения",enchantable:"заточки",enchant_level:"Ур. заточки",max_duration:"Макс. долговечность",time:"Время жизни",time_action:"Время жизни умения",description:"Описание",skill:"Навык",image:"Изображение"},Le={armor:"броня",weapon:"оружие",potion:"эликсир",fish:"рыба",herb:"трава",scroll:"свиток",head:"шлем",ear:"серьги",neck:"ожерелье",chest:"нагрудник",gloves:"перчатки",finger:"кольцо",legs:"штаны",feet:"сапоги",underwear:"рубаха",rhand:"правая рука",lhand:"левая рука",dblhand:"двуручное",none:"неизвестно",light:"легкая",heavy:"тяжелая",robe:"роба",cloth:"ткань",leather:"кожа",wood:"древесина",steel:"сталь",dagger:"кинжал",ax:"топор",mace:"молот","fishing rod":"удочка",gift:"подарок",trash:"мусор"},Ae={level:"Уровень",power:"Сила",critical:"Интуиция",evasion:"Ловкость",defence:"Защита",stamina:"Выносливость",gold:"Золото",exp:"Опыт",win:"Побед",defeat:"Поражений",draw:"Ничьих"},Re={components:{PackItem:me,UserInfo:Se,UserShortInfo:S},props:{user:Object,items:Array,info:{type:Array,required:!1},isFight:Boolean,damage:{type:Array,required:!1,default:function(){return[]}}},data:function(){return{damageShowActive:!1}},computed:Object(b["a"])(Object(b["a"])({},Object(s["b"])(["userItems"])),{},{userInfo:function(){var t,e=this.setLangInfo(this.getLangInfoKeys,this.user);e.length>1&&(e.splice(1,0,{k:"Урон",v:"+".concat(this.user.min_damage+this.user.extra_min_damage,"...+").concat(this.user.max_damage+this.user.extra_max_damage)}),this.userItems&&e.splice(-1,1,{k:"Золото",v:(null===(t=this.userItems.find((function(t){return 1==t.item_id})))||void 0===t?void 0:t.count)||0}));return e},fightUserInfo:function(){return this.setLangInfo(this.getLangInfoKeys,this.fightUser)},getLangInfoKeys:function(){return this.info?this.info:["power","critical","evasion","defence","stamina","win","defeat","draw","exp","gold"]},image:function(){var t;return"img/images/"+(null!==(t=this.user.image)&&void 0!==t?t:this.user.sex+".png")}}),methods:{getSlot:function(t){var e=[t];"rhand"===t&&e.push("dblhand");var n=this.items.filter((function(t){return e.includes(t.body_part)}));return n[0]?n[0]:{image:"/img/slots/".concat(t,".png")}},setLangInfo:function(t,e){return t.map((function(t){return{k:Ae[t],v:e[t]}}))},showDamage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e,s=50,r=setInterval((function(){--e||clearInterval(r),i-=1,s>20&&s<80&&(s+=1===c?-2:2===c?2:0);try{_("#d-"+t).css({top:i+"%",left:s+"%"})}catch(n){}}),1e3/n)}},mounted:function(){var t=this,e=15,n=50;this.damage.length&&setTimeout((function(){t.showDamage(t.damage[0].id,n,e,rand(0,2))}),2e3)},updated:function(){},watch:{damage:function(t){}}};n("c1d9");Re.render=_e;var xe=Re,Me={key:0,class:"item-info"},Ne={class:"name"},Ue={class:"info"},$e={class:"main row"},Fe={class:"col-md-1"},He={class:"col-md-8",style:{"padding-left":"50px"}},qe={class:"body-part"},De={class:"body-duration"},Ve={class:"price"},Be={class:"stats"},Pe={class:"name col-md-6"},Qe={class:"value col-md-6"};function Ge(t,e,n,i,s,r){return t.activeItem?(Object(c["k"])(),Object(c["d"])("div",Me,[Object(c["g"])("div",Ne,Object(c["t"])(s.item.name),1),Object(c["g"])("div",Ue,[Object(c["g"])("div",$e,[Object(c["g"])("div",Fe,[Object(c["g"])("img",{src:s.item.image,class:"img"},null,8,["src"])]),Object(c["g"])("div",He,[Object(c["g"])("div",qe,"Тип: "+Object(c["t"])(r.langValue(s.item.body_part)),1),Object(c["g"])("div",De," Состояние: "+Object(c["t"])(s.item.duration||-1)+"/"+Object(c["t"])(s.item.max_duration||-1),1),Object(c["g"])("div",Ve,"Цена: "+Object(c["t"])(s.item.price),1)]),Object(c["g"])("div",{class:["col-md-3",{red:s.item.need_level>t.user.level}]}," Ур.: "+Object(c["t"])(s.item.need_level),3)]),Object(c["g"])("div",Be,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(s.itemProps[s.item.item_id],(function(t){return Object(c["k"])(),Object(c["d"])("div",{class:"row",key:t},[Object(c["g"])("div",Pe,Object(c["t"])(t.name),1),Object(c["g"])("div",Qe,Object(c["t"])(t.value),1)])})),128))])])])):Object(c["e"])("",!0)}var We={data:function(){return{item:null,itemProps:{},autoList:["power","critical","evasion","stamina","hp","weight","item_type","material"]}},computed:Object(b["a"])({},Object(s["b"])(["activeItem","user"])),watch:{activeItem:function(t){this.item=t,this.itemPropsView(t)}},methods:{itemPropsView:function(t){var e=this;t&&(this.itemProps[t.item_id]||(this.itemProps[t.item_id]=[],this.autoList.forEach((function(n){var c=+t[n];if(0!==c){var i=isNaN(c)?t[n]:"+"+t[n];e.addItemProp(t.item_id,n,i)}})),"weapon"===t.item_type&&this.addItemProp(t.item_id,"Урон","+".concat(t.min_damage,"...+").concat(t.max_damage),!0)))},addItemProp:function(t,e,n){var c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.itemProps[t].push({name:c?e:Ce[e],value:Le[n]?Le[n]:n})},langValue:function(t){return Le[t]}}};n("266c");We.render=Ge;var Ke=We,ze=n("440a"),Je={components:{ItemLists:je,UserForm:xe,ItemInfo:Ke},inject:["api","apiSubscribe"],data:function(){return{currentItem:null}},mounted:function(){var t=this;this.api.doAction("getBackPack","",(function(e){t.$store.commit("SET_USER_ITEMS",e)})),this.apiSubscribe({wearItem:function(e){t.useReaction(e,"ON")},takeoffItem:function(e){t.useReaction(e,"OFF")},removeItem:function(e){t.useReaction(e,"REM")}})},computed:Object(b["a"])(Object(b["a"])({},Object(s["b"])(["user"])),{},{items:function(){return this.$store.state.userItems},packedItems:function(){return this.filterByLoc(this.items,"INVENTORY")},wearedItems:function(){return this.filterByLoc(this.items,"WEARING")}}),methods:{removeItem:function(t){var e=this;this.api.doAction("removeItem",t.id,(function(n){e.$store.commit("REMOVE_ITEM",t.id)}))},wearItem:function(t){if(t.need_level>this.user.level)return this.$store.commit("SET_MODAL",{title:"Уровень персонажа слишком мал для применения данной вещи"});this.use(t,"ON")},takeoffItem:function(t){this.use(t,"OFF")},use:function(t,e){var n=this.identifyActionType(e),c=Object(Jt["a"])(n,1),i=c[0];this.api.doAction(i,t.id)},useReaction:function(t,e){if(Object(ze["b"])(t)){var n=this.identifyActionType(e),c=Object(Jt["a"])(n,2),i=c[1];this.$store.commit(i,t)}},identifyActionType:function(t){var e,n;return"ON"==t?(e="wearItem",n="PUT_ON_ITEM"):"OFF"==t?(e="takeoffItem",n="TAKE_OFF_ITEM"):"REM"==t&&(n="REMOVE_ITEM"),[e,n]},filterByLoc:function(t,e){var n=[];for(var c in t)t[c].loc===e&&n.push(t[c]);return n}}};n("4220");Je.render=zt;var Ye=Je,Xe={class:"supply-slots flex"},Ze={key:0},tn={key:1,class:"dome"};function en(t,e,n,i,s,r){return Object(c["k"])(),Object(c["d"])("div",Xe,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(s.supplySlotsCount,(function(t){return Object(c["k"])(),Object(c["d"])("div",{class:"supply-slot",key:t},[s.supplies[t-1]?(Object(c["k"])(),Object(c["d"])("div",Ze,[Object(c["g"])("img",{src:"img/items/"+s.supplies[t-1].image},null,8,["src"]),Object(c["g"])("div",{class:"dome",onClick:function(e){return r.use(s.supplies[t-1].id)}},null,8,["onClick"])])):(Object(c["k"])(),Object(c["d"])("div",tn))])})),128))])}var nn={name:"UserSupplies",data:function(){return{supplies:[{id:1,image:"life_potion.jpg"}],supplySlotsCount:4}},methods:{use:function(t){console.log(t)}}};n("e0b4");nn.render=en;var cn=nn,sn=Object(c["A"])("data-v-e77b504c");Object(c["m"])("data-v-e77b504c");var rn={class:"test"},an={key:0,class:"debug"},on=Object(c["g"])("h1",{class:"center"},"DEBUG",-1),un={class:"row"},ln={key:0},dn={key:0},bn=Object(c["g"])("hr",null,null,-1),mn={class:"col-md-8"},On={class:"col-md-4"},fn={key:1,class:"row"},gn={class:"col-md-8"},jn={class:"col-md-4"};Object(c["l"])();var hn=sn((function(t,e,n,i,s,r){var a;return Object(c["k"])(),Object(c["d"])(c["a"],null,[Object(c["g"])("div",rn,[Object(c["g"])("div",null,Object(c["t"])(t.game)+" "+Object(c["t"])(t.players)+" "+Object(c["t"])(t.counter),1),Object(c["g"])("div",null,Object(c["t"])(t.a),1)]),(Object(c["k"])(),Object(c["d"])("div",an,[on,Object(c["g"])("button",{onClick:e[1]||(e[1]=function(){return r.getAppData&&r.getAppData.apply(r,arguments)})},"Update"),Object(c["g"])("div",un,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(null===(a=s.appData)||void 0===a?void 0:a.server,(function(t,e){return Object(c["k"])(),Object(c["d"])("div",{class:"col col-3",key:e},["userRepo"===e?(Object(c["k"])(),Object(c["d"])("div",ln,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t.users,(function(t,e){return Object(c["k"])(),Object(c["d"])("div",{key:e,class:"row rcol"},[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t.attr,(function(t,e){return Object(c["k"])(),Object(c["d"])("div",{key:e,class:"row"},["packItems"===e?(Object(c["k"])(),Object(c["d"])("div",dn,[bn,(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t[Object.keys(t)[0]],(function(t,e){return Object(c["k"])(),Object(c["d"])("div",{key:e,class:"row"},[Object(c["g"])("div",mn,Object(c["t"])(e),1),Object(c["g"])("div",On,Object(c["t"])(t),1)])})),128))])):(Object(c["k"])(),Object(c["d"])("div",fn,[Object(c["g"])("div",gn,Object(c["t"])(e),1),Object(c["g"])("div",jn,Object(c["t"])(t),1)]))])})),128))])})),128))])):Object(c["e"])("",!0)])})),128))])])),(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t.teams,(function(t){return Object(c["k"])(),Object(c["d"])("div",{key:t},Object(c["t"])(t),1)})),128)),Object(c["g"])("button",{onClick:e[2]||(e[2]=function(e){return t.addFighter({id:1,level:1})})},"addFighter"),Object(c["g"])("button",{onClick:e[3]||(e[3]=function(e){return t.changeFighter()})},"changeFighter"),Object(c["f"])(" "+Object(c["t"])(s.user),1)],64)})),vn={inject:["api","apiSubscribe"],data:function(){return{appData:null,user:{id:2},users:[{id:2},{id:3}]}},mounted:function(){var t=this;this.apiSubscribe(["debug"],this),setTimeout((function(){console.log(1),t.user=t.users[1]}),2e3)},computed:{},updated:function(){},methods:{debug:function(t){this.appData=t},getAppData:function(){this.api.doAction("debug")}}};vn.render=hn,vn.__scopeId="data-v-e77b504c";var pn=vn,kn={key:0,class:"fight row center"},yn={class:"fighter-slot-left"},In={class:"fighters"},Tn={class:"stats-wrapper"},_n={class:"stats"},En={class:"user-stats col-md-5"},wn={class:"col-md-2 damage-score"},Sn=Object(c["g"])("div",null,"Нанесено урона",-1),Cn={key:0,class:"enemy-stats col-md-5"},Ln={key:0,class:"timer"},An={key:1,class:"controls"},Rn={key:2,class:"end-fight"},xn=Object(c["g"])("div",{class:"title"},"Бой окончен",-1),Mn={class:"content"},Nn={key:3,class:"super-hit"},Un={class:"center fighter-slot-right"},$n={key:0,class:"center"},Fn={key:0,class:"changing-enemy icon-spin3 active"},Hn={key:1},qn=Object(c["g"])("h3",null,"Ожидание противника...",-1),Dn={class:"teams-wrapper"},Vn={class:"teams myblock row center"},Bn={class:"col-md-6 team1"},Pn=Object(c["g"])("div",{class:"team-title"},[Object(c["f"])("Команда 1"),Object(c["g"])("hr")],-1),Qn={class:"fighter-list"},Gn={class:"col-md-6 team2"},Wn=Object(c["g"])("div",{class:"team-title"},[Object(c["f"])("Команда 2"),Object(c["g"])("hr")],-1),Kn={class:"fighter-list"},zn=Object(c["g"])("div",null,null,-1);function Jn(t,e,n,i,s,r){var a=Object(c["r"])("user-form"),o=Object(c["r"])("user-short-info"),u=Object(c["r"])("fighter-model");return Object(c["k"])(),Object(c["d"])(c["a"],null,[i.loaded?(Object(c["k"])(),Object(c["d"])("div",kn,[Object(c["g"])("div",yn,[Object(c["g"])(a,{items:i.wearedItems,user:i.user,info:[],isFight:!1},null,8,["items","user"])]),Object(c["g"])("div",{class:"flex fcol fight-panel",style:"background-image: url('/img/locations/".concat(i.image,"')")},[Object(c["g"])("div",In,[Object(c["g"])("div",Tn,[Object(c["g"])("div",_n,[Object(c["g"])("div",En,[Object(c["g"])(o,{user:i.user},null,8,["user"])]),Object(c["g"])("div",wn,[Sn,Object(c["g"])("div",null,Object(c["t"])(i.user.damage),1)]),i.user.getEnemy()&&!i.isChangingEnemy?(Object(c["k"])(),Object(c["d"])("div",Cn,[Object(c["g"])(o,{user:i.user.getEnemy()},null,8,["user"])])):Object(c["e"])("",!0)]),!i.user.getEnemy()||i.user.delay||i.isChangingEnemy?Object(c["e"])("",!0):(Object(c["k"])(),Object(c["d"])("div",Ln,Object(c["t"])(i.timer),1)),!i.user.getEnemy()||!i.turn||i.user.delay||i.isChangingEnemy||i.fight.isFightEnd.value?Object(c["e"])("",!0):(Object(c["k"])(),Object(c["d"])("div",An,[Object(c["g"])("div",null,[Object(c["g"])("button",{onClick:e[1]||(e[1]=function(t){return i.hit(1)})},"→")]),Object(c["g"])("div",null,[Object(c["g"])("button",{onClick:e[2]||(e[2]=function(t){return i.hit(2)})},"→")]),Object(c["g"])("div",null,[Object(c["g"])("button",{onClick:e[3]||(e[3]=function(t){return i.hit(3)})},"→")])])),i.fight.isFightEnd.value?(Object(c["k"])(),Object(c["d"])("div",Rn,[xn,Object(c["g"])("div",Mn,Object(c["t"])(i.user.team===i.fight.winTeam?"Победа":"Поражение"),1),Object(c["g"])("button",{class:"fight-exit",onClick:e[4]||(e[4]=function(){return i.toStatistics&&i.toStatistics.apply(i,arguments)})},"Выход")])):Object(c["e"])("",!0),i.user.superHit?(Object(c["k"])(),Object(c["d"])("div",Nn,"Супер-удар")):Object(c["e"])("",!0)]),Object(c["g"])(u,{side:"left",damage:i.user.damageMe,key:1},null,8,["damage"]),Object(c["g"])(u,{side:"right",damage:i.user.damageEnemy,key:2,class:["enemy-fighter",{change:!i.user.getEnemy()||i.isChangingEnemy}]},null,8,["damage","class"])])],4),Object(c["g"])("div",Un,[i.user.getEnemy()?(Object(c["k"])(),Object(c["d"])("div",$n,[i.isChangingEnemy?(Object(c["k"])(),Object(c["d"])("div",Fn)):(Object(c["k"])(),Object(c["d"])(a,{key:1,items:[],user:i.user.getEnemy(),info:[],isFight:!1},null,8,["user"]))])):(Object(c["k"])(),Object(c["d"])("div",Hn,[qn]))]),Object(c["g"])("div",Dn,[Object(c["g"])("div",Vn,[Object(c["g"])("div",Bn,[Pn,Object(c["g"])("div",Qn,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(i.fight.teams[0],(function(t,e){var n;return Object(c["k"])(),Object(c["d"])("div",{key:e},[Object(c["g"])("div",{class:[{active:(null===(n=i.user.getEnemy())||void 0===n?void 0:n.fId)==t.fId},"fighter-list-item"]},[Object(c["g"])(o,{user:t,shrink:""},null,8,["user"])],2)])})),128))])]),Object(c["g"])("div",Gn,[Wn,Object(c["g"])("div",Kn,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(i.fight.teams[1],(function(t,e){var n;return Object(c["k"])(),Object(c["d"])("div",{key:e},[Object(c["g"])("div",{class:[{active:(null===(n=i.user.getEnemy())||void 0===n?void 0:n.fId)==t.fId},"fighter-list-item"]},[Object(c["g"])(o,{user:t,shrink:""},null,8,["user"])],2)])})),128))])])])])])):Object(c["e"])("",!0),zn],64)}var Yn=Object(c["g"])("div",{class:"fighter"},null,-1),Xn=Object(c["g"])("div",{class:"damage"},null,-1);function Zn(t,e,n,i,s,r){return Object(c["k"])(),Object(c["d"])("div",{class:["fighter-wrapper",n.side]},[Yn,Xn],2)}var tc,ec,nc=n("ade3"),cc=n("2909"),ic=n("d4ec"),sc=n("bee2"),rc=2,ac=3,oc=4,uc=10,lc=function(){function t(e,n){Object(ic["a"])(this,t),tc=n,Object.assign(this,e)}return Object(sc["a"])(t,[{key:"getEnemy",value:function(){return this.swap&&tc.fighters[this.enemyfId]}},{key:"setEnemy",value:function(t){this.enemyfId=t.fId,t.enemyfId=this.fId}},{key:"clearEnemy",value:function(){var t=this;return setTimeout((function(){t.enemyfId=null,t.swap=null,t.lastEnemyfId=null}),1e3)}},{key:"getTimeTurnLeft",value:function(){return this.swap?Math.round(this.swap[oc]-(Date.now()/1e3-uc)):null}},{key:"hit",value:function(t){tc.tempToggle.call(this,"delay")}},{key:"isBot",value:function(){return"undefined"!=typeof this.aggr}},{key:"isMe",value:function(){return!this.isBot()&&this.id==tc.userId}},{key:"shiftHit",value:function(){this.swap[ac]--}},{key:"hitsExist",value:function(){var t;return null!==(t=this.swap[ac])&&void 0!==t?t:null}},{key:"swapTick",value:function(){this.swap[ac]--,this.swap[rc]=this.swap[rc]?0:1,this.swap[oc]=Date.now()/1e3}}]),t}();var dc=1,bc=2,mc=3,Oc=(ec={},Object(nc["a"])(ec,dc,"голову"),Object(nc["a"])(ec,bc,"корпус"),Object(nc["a"])(ec,mc,"ноги"),ec),fc={HAND:3,LEG:7,EVASION:4,BLOCK:1,SUPER:7};var gc,jc=function(){function t(){Object(ic["a"])(this,t),this.store=Object(s["e"])(),this.userId=this.store.state.user.id,this.fighters=Object(c["n"])({}),this.teams=Object(c["n"])([{},{}]),this.isFightEnd=Object(c["o"])(!1),this.winTeam=Object(c["o"])(null),this.hitId=1,this.loaded=!1,this.user=Object(c["n"])(new lc({lastEnemyfId:null,turn:null,damage:0,fightExp:0,kills:0,delay:!1,superHit:null,damageMe:null,damageEnemy:null},this))}return Object(sc["a"])(t,[{key:"setFighters",value:function(t){var e=this;Object.entries(t).forEach((function(t){var n=Object(Jt["a"])(t,2),c=(n[0],n[1]),i=new lc(c,e);i.isMe()&&(Object.assign(e.user,i),e.user.lastEnemyfId=e.user.enemyfId,i=e.user),e.fighters[i.fId]=i,e.teams[i.team][i.fId]=i})),this.loaded=!0}},{key:"setLog",value:function(t,e,n,c,i,s,r,a){var o,u=fc.HAND,l=!1,d="-",b="black";r?(l=fc.EVASION,o="уворот",b="green"):s?(l=fc.BLOCK,o="блок",b="blue"):(a?(this.tempToggle("superHit"),u=fc.SUPER,d="супер-удар"):d="ударил",i&&(b="red"),o="в ".concat(Oc[c],' на -<span style="color: ').concat(b,';">').concat(n,"</span>(").concat(e.curhp,"/").concat(e.maxhp,")")),t.fId===this.user.fId?(this.user.damageEnemy=[l,n,i,this.hitId++],this.user.damageMe=[u,!1,i,this.hitId++]):(this.user.damageMe=[l,n,i,this.hitId++],this.user.damageEnemy=[u,!1,i,this.hitId++]),this.store.commit("ADD_FIGHT_LOG","".concat(t.login,"[").concat(t.level,"] ").concat(d," ").concat(e.login,"[").concat(e.level,"] ").concat(o)),e.curhp<=0&&this.store.commit("ADD_FIGHT_LOG","".concat(e.login,"[").concat(e.level,"] погибает."))}},{key:"tempToggle",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this[t]=n,setTimeout((function(){e[t]=!n}),c)}}]),t}(),hc={props:["side","damage"],watch:{damage:function(t){pc(this.side).apply(void 0,Object(cc["a"])(t))}}},vc=(gc={},Object(nc["a"])(gc,fc.HAND,3),Object(nc["a"])(gc,fc.LEG,5),Object(nc["a"])(gc,fc.EVASION,4),Object(nc["a"])(gc,fc.BLOCK,4),Object(nc["a"])(gc,fc.SUPER,5),gc);function pc(t){var e=177,n=_(".fighter-wrapper.".concat(t," .fighter")),c=_(".fighter-wrapper.".concat(t," .damage"));return kc(n),function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=vc[t];r||(r=0),r--;var a=-200*(t-1),o=0,u=0;t===fc.HAND&&(u=-e,r--);var l=u,d="white";if(t===fc.EVASION?(d="lightgreen",i="Уворот"):t===fc.BLOCK?(d="black",i="Блок"):!1!==i&&(s&&(d="red"),t===fc.SUPER&&(d="gold"),isNumeric(i)&&(i="-".concat(i)),c.html('<span style="color: '.concat(d,';">').concat(i,"</span>")).addClass("active")),!1!==t&&!1!==i&&c.html('<span style="color: '.concat(d,';">').concat(i,"</span>")).addClass("active"),setTimeout((function(){c.removeClass("active")}),1e3),!1!==t){yc(n,l,a);var b=function(t){o++,l+=t?-e:e,yc(n,l,a)},m=setInterval((function(){if(o>=r)return kc(n),void clearInterval(m);b(o<=r)}),200)}}}function kc(t){yc(t,0,-400)}function yc(t,e,n){t.css("backgroundPosition","".concat(e,"px ").concat(n,"px"))}n("2305");hc.render=Zn;var Ic=hc,Tc={components:{UserShortInfo:S,UserForm:xe,FighterModel:Ic},setup:function(t,e){var n,i,r,a,o,u=e.emit,l=Object(s["e"])(),d=2,b=Object(c["i"])("api"),m=Object(c["i"])("apiSubscribe"),O=new jc,f=O.user,g=Object(c["b"])((function(){return Object(ze["a"])(l.state.userItems,"WEARING")||[]})),j=Object(c["b"])((function(){return f.swap&&f.swap[d]===f.team&&f.hitsExist()})),h=Object(c["o"])(!1),v=Object(c["o"])(""),p=Object(c["o"])(!1),k=null;function y(t){var e=t[i];if(f.lastEnemyfId!=e){if(null==f.lastEnemyfId)return f.setEnemy(O.fighters[e]),void(f.lastEnemyfId=e);f.lastEnemyfId=e,clearTimeout(k),setTimeout((function(){h.value=!0}),500),k=setTimeout((function(){h.value=!1,f.setEnemy(O.fighters[e])}),1e3)}}m({_fight:function(t){var e=t;if(e.fighters&&(O.setFighters(e.fighters),p.value=!0,i=0==f.team?1:0),e.hit&&(a=O.fighters[e.hit.hitter],o=O.fighters[e.hit.defender],o.curhp-=e.hit.damage,a.damage+=e.hit.damage,(a.isMe()||o.isMe())&&(O.setLog(a,o,e.hit.damage,e.hit.type,e.hit.crit,e.hit.block,e.hit.evasion,e.hit.superHit),f.swapTick(),f.hitsExist()||(r=f.clearEnemy()))),e.kill){var n=e.kill.fId;O.fighters[n].curhp=0,f.fId!=n&&f.enemyfId!=n||(clearTimeout(r),r=f.clearEnemy())}e.swap&&O.loaded&&(clearTimeout(r),f.swap=e.swap,y(e.swap)),e.statistics&&(O.winTeam=e.statistics.winTeam,O.isFightEnd.value=!0,l.commit("SET_FIGHTSTATS",e.statistics))}});var I=Object(c["b"])((function(){return f.getEnemy()}));function T(){n=setInterval((function(){if(O.isFightEnd.value)return v.value="",void clearInterval(n);var t=f.getTimeTurnLeft();v.value=null===t?t:timer(t>0?t:0,"i:s",!1)}),1e3)}Object(c["j"])((function(){Object(ze["c"])(b,l),T()}));var _=Object(c["b"])((function(){return l.state.location.image}));function E(){u("setCurComp","FightStats")}function w(t){b.doAction("hit",t),f.hit(t)}return{fight:O,toStatistics:E,turn:j,user:f,timer:v,isChangingEnemy:h,loaded:p,getEnemy1:I,image:_,hit:w,wearedItems:g}}};n("9d7b");Tc.render=Jn;var _c=Tc,Ec={key:0,class:"fight-stats "},wc={class:"center"},Sc=Object(c["f"])("Бой окончен! Вы нанесли "),Cc=Object(c["f"])(" урона, убийств: "),Lc=Object(c["f"])(". Получено опыта "),Ac=Object(c["f"])("."),Rc={class:"row"},xc=Object(c["g"])("div",{class:"col-md-3"},[Object(c["g"])("img",{src:"/img/fight/5.jpg"})],-1),Mc={class:"col-md-6 stats myblock center"},Nc={class:"row buttons"},Uc={class:"col-md-4"},$c={class:"col-md-4"},Fc={class:"col-md-4"},Hc=Object(c["g"])("hr",null,null,-1),qc={class:"row times"},Dc={class:"col-md-4"},Vc={class:"col-md-4"},Bc={class:"col-md-4"},Pc=Object(c["g"])("hr",null,null,-1),Qc={class:"row teams"},Gc={class:"col-md-6 team1"},Wc=Object(c["g"])("h5",null,"1я команда",-1),Kc=Object(c["g"])("hr",null,null,-1),zc={border:"1"},Jc=Object(c["g"])("tr",null,[Object(c["g"])("th",null,"Игрок"),Object(c["g"])("th",null,"Опыт"),Object(c["g"])("th",null,"Урон"),Object(c["g"])("th",null,"Убийств")],-1),Yc={class:"col-md-6 team2"},Xc=Object(c["g"])("h5",null,"2я команда",-1),Zc=Object(c["g"])("hr",null,null,-1),ti={border:"1"},ei=Object(c["g"])("tr",null,[Object(c["g"])("th",null,"Игрок"),Object(c["g"])("th",null,"Опыт"),Object(c["g"])("th",null,"Урон"),Object(c["g"])("th",null,"Убийств")],-1),ni=Object(c["g"])("div",{class:"col-md-3"},[Object(c["g"])("img",{src:"/img/fight/4.jpg"})],-1);function ci(t,e,n,i,s,r){return this.$store.state.fightStats?(Object(c["k"])(),Object(c["d"])("div",Ec,[Object(c["g"])("h4",wc,[Sc,Object(c["g"])("b",null,Object(c["t"])(s.user.damage),1),Cc,Object(c["g"])("b",null,Object(c["t"])(s.user.kills),1),Lc,Object(c["g"])("b",null,Object(c["t"])(s.user.fightExp),1),Ac]),Object(c["g"])("div",Rc,[xc,Object(c["g"])("div",Mc,[Object(c["g"])("div",Nc,[Object(c["g"])("div",Uc,[Object(c["g"])("button",{class:"btn",onClick:e[1]||(e[1]=function(e){return t.$emit("setCurComp","LocationWrapper")})},"В локацию")]),Object(c["g"])("div",$c,[Object(c["g"])("button",{onClick:e[2]||(e[2]=function(e){return t.$emit("setCurComp","UserBackpack")})},"В рюкзак")]),Object(c["g"])("div",Fc,[Object(c["g"])("button",{onClick:e[3]||(e[3]=function(e){return t.$emit("setCurComp","TheHunting")})},"На охоту")])]),Hc,Object(c["g"])("div",qc,[Object(c["g"])("div",Dc," Начало боя: "+Object(c["t"])(r.formattedStartTime),1),Object(c["g"])("div",Vc," Победила "+Object(c["t"])(t.$store.state.fightStats.winTeam?2:1)+"я команда ",1),Object(c["g"])("div",Bc," Длительность: "+Object(c["t"])(r.fightDuration),1)]),Pc,Object(c["g"])("div",Qc,[Object(c["g"])("div",Gc,[Wc,Kc,Object(c["g"])("table",zc,[Jc,(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t.$store.state.fightStats.teamsStatisticts[0],(function(t){return Object(c["k"])(),Object(c["d"])("tr",{key:t.id},[Object(c["g"])("td",null,Object(c["t"])(t.login)+"["+Object(c["t"])(t.level)+"]",1),Object(c["g"])("td",null,Object(c["t"])(t.fightExp),1),Object(c["g"])("td",null,Object(c["t"])(t.damage),1),Object(c["g"])("td",null,Object(c["t"])(t.kills),1)])})),128))])]),Object(c["g"])("div",Yc,[Xc,Zc,Object(c["g"])("table",ti,[ei,(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(t.$store.state.fightStats.teamsStatisticts[1],(function(t){return Object(c["k"])(),Object(c["d"])("tr",{key:t.id},[Object(c["g"])("td",null,Object(c["t"])(t.login)+"["+Object(c["t"])(t.level)+"]",1),Object(c["g"])("td",null,Object(c["t"])(t.fightExp),1),Object(c["g"])("td",null,Object(c["t"])(t.damage),1),Object(c["g"])("td",null,Object(c["t"])(t.kills),1)])})),128))])])])]),ni])])):Object(c["e"])("",!0)}var ii={emits:["setCurComp"],data:function(){return{user:{}}},computed:{formattedStartTime:function(){return date("Y-m-d H:i:s",new Date(1e3*this.$store.state.fightStats.startTime))},fightDuration:function(){var t=((new Date).getTime()-1e3*new Date(this.$store.state.fightStats.startTime))/1e3;return timer(t)}},mounted:function(){var t=this;if(this.$store.state.fightStats){var e=!1;this.$store.state.fightStats.teamsStatisticts.forEach((function(n){if(!e)for(var c in n)if(+c===t.$store.state.user.id)return t.user=n[c],void(e=!0)}))}}};n("e610");ii.render=ci;var si=ii,ri={key:0,class:"main-modal"},ai={class:"modal"},oi={key:0,class:"title"},ui={key:1,class:"message"};function li(t,e,n,i,s,r){return r.modal?(Object(c["k"])(),Object(c["d"])("div",ri,[Object(c["g"])("div",ai,[r.modal.title?(Object(c["k"])(),Object(c["d"])("div",oi,Object(c["t"])(r.modal.title),1)):Object(c["e"])("",!0),r.modal.message?(Object(c["k"])(),Object(c["d"])("div",ui,Object(c["t"])(r.modal.message),1)):Object(c["e"])("",!0),Object(c["g"])("button",{class:"close",onClick:e[1]||(e[1]=function(){return r.close&&r.close.apply(r,arguments)})},"Закрыть")])])):Object(c["e"])("",!0)}var di={data:function(){return{}},computed:{modal:function(){var t=this.$store.state.modal;return"string"==typeof t?{message:t}:t}},mounted:function(){},methods:{close:function(){this.$store.commit("SET_MODAL",null)}}};n("7759");di.render=li;var bi=di,mi={class:"npc-view"},Oi={class:"row"},fi={class:"col-md-3 npc-info"},gi={class:"center npc-info-name"},ji={class:"center npc-info-img"},hi={class:"npc-info-text"},vi={class:"col-md-9 quests"},pi=Object(c["g"])("h2",{class:"center"},"Квесты",-1),ki=Object(c["g"])("hr",null,null,-1),yi={key:0,class:"active-quest"},Ii={class:"center"},Ti={class:"quest-text"},_i={key:0,class:"quest-reward"},Ei={class:"quest-answers"},wi={key:1,class:"quest-answers"},Si={key:2,class:"quest-answers"},Ci={key:1},Li={class:"name"},Ai={key:2};function Ri(t,e,n,i,s,r){var a=Object(c["r"])("pack-item");return Object(c["k"])(),Object(c["d"])("div",mi,[Object(c["g"])("div",Oi,[Object(c["g"])("div",fi,[Object(c["g"])("h2",gi,Object(c["t"])(n.npc.name),1),Object(c["g"])("div",ji,[Object(c["g"])("img",{src:"/img/npc/".concat(n.npc.image)},null,8,["src"])]),Object(c["g"])("div",hi,Object(c["t"])(r.text),1)]),Object(c["g"])("div",vi,[pi,ki,s.activeQuest?(Object(c["k"])(),Object(c["d"])("div",yi,[Object(c["g"])("h3",Ii,Object(c["t"])(s.activeQuest.name),1),Object(c["g"])("div",Ti,Object(c["t"])(s.activeQuest.data.text),1),s.activeQuest.data.reward?(Object(c["k"])(),Object(c["d"])("div",_i,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(s.activeQuest.data.reward,(function(t){return Object(c["k"])(),Object(c["d"])("div",{key:t},[Object(c["g"])(a,{item:t},null,8,["item"])])})),128)),Object(c["g"])("div",Ei,[Object(c["g"])("ul",null,[Object(c["g"])("li",null,[Object(c["g"])("span",{onClick:e[1]||(e[1]=function(){return r.takeReward&&r.takeReward.apply(r,arguments)})},"Забрать награду")])])])])):Object(c["e"])("",!0),s.activeQuest.data.answers?(Object(c["k"])(),Object(c["d"])("div",wi,[Object(c["g"])("ul",null,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(s.activeQuest.data.answers,(function(t,e){return Object(c["k"])(),Object(c["d"])("li",{key:e},[Object(c["g"])("span",{onClick:function(t){return r.doAnswer(e)}},Object(c["t"])(t),9,["onClick"])])})),128))])])):(Object(c["k"])(),Object(c["d"])("div",Si,[Object(c["g"])("ul",null,[Object(c["g"])("li",null,[Object(c["g"])("span",{onClick:e[2]||(e[2]=function(){return r.exit&&r.exit.apply(r,arguments)})},"Закрыть")])])]))])):s.quests?(Object(c["k"])(),Object(c["d"])("div",Ci,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(s.quests,(function(t){return Object(c["k"])(),Object(c["d"])("div",{key:t.id},[Object(c["g"])("div",{class:"quest",onClick:function(e){return r.showQuest(t.id)}},[Object(c["g"])("div",Li,Object(c["t"])(t.name),1)],8,["onClick"])])})),128))])):(Object(c["k"])(),Object(c["d"])("div",Ai,"На данный момент квестов нет"))])])])}var xi={components:{PackItem:me},props:{npc:Object},inject:["api","apiSubscribe"],data:function(){return{quests:[],activeQuest:null}},created:function(){var t=this;this.apiSubscribe({quests:function(e){t.quests=e}})},methods:{showQuest:function(t){var e=this;this.api.doAction("showQuest",{npcId:this.npc.id,questId:t},(function(t){e.activeQuest=t}))},doAnswer:function(t){var e=this;this.api.doAction("questAnswer",{npcId:this.activeQuest.npc_id,questId:this.activeQuest.id,answerId:t},(function(t){e.activeQuest=t}))},exit:function(){this.activeQuest=null},takeReward:function(){var t=this;this.api.doAction("takeReward",{npcId:this.activeQuest.npc_id,questId:this.activeQuest.id},(function(e){t.activeQuest=null})),delete this.quests[this.activeQuest.id],this.activeQuest=null}},computed:{text:function(){return 5==this.npc.id?"Статуя древнего воина, в этом городе, была возведена еще несколько тысяч лет назад. Неиссякаемая магия всесильных богов вселила в сию статую душу древнего воина и с тех пор он чувствует всё вокруг и может взаимодействовать с миром.":null}}};n("a897");xi.render=Ri;var Mi=xi,Ni={class:"quest-list"},Ui=Object(c["g"])("h2",{class:"center"},"Квесты",-1),$i={class:"__list"};function Fi(t,e,n,i,s,r){var a=Object(c["r"])("simple-tabs"),o=Object(c["r"])("quest-item");return Object(c["k"])(),Object(c["d"])("div",Ni,[Ui,Object(c["g"])(a,{tabs:s.types,onChange:r.setType,counts:r.countEachQuestTypes},null,8,["tabs","onChange","counts"]),Object(c["g"])("div",$i,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(s.quests[s.activeType],(function(t,e){return Object(c["k"])(),Object(c["d"])("div",{class:"__item",key:e},[Object(c["g"])(o,{quest:t},null,8,["quest"])])})),128))])])}var Hi={class:"tabs"};function qi(t,e,n,i,s,r){return Object(c["k"])(),Object(c["d"])("div",Hi,[(Object(c["k"])(!0),Object(c["d"])(c["a"],null,Object(c["p"])(n.tabs,(function(t,e){return Object(c["k"])(),Object(c["d"])("button",{key:t,class:["tab-button",{active:s.activeTab===e}],onClick:function(t){return r.change(e)}},Object(c["t"])(t)+" "+Object(c["t"])(r.countTabItems(e)),11,["onClick"])})),128))])}var Di={props:{tabs:Object,counts:{type:Object,default:null}},emits:{activeTab:String},data:function(){return{activeTab:null}},methods:{change:function(t){this.activeTab=t,this.$emit("change",t)},countTabItems:function(t){return this.counts[t]?" (".concat(this.counts[t],")"):" (0)"}},mounted:function(){this.activeTab=Object.keys(this.tabs)[0]}};n("040e");Di.render=qi;var Vi=Di,Bi={class:"quest-item"},Pi={class:"__detail"},Qi={class:"__text"},Gi={class:"__condition"};function Wi(t,e,n,i,s,r){return Object(c["k"])(),Object(c["d"])("div",Bi,[Object(c["g"])("div",{class:"__name",onClick:e[1]||(e[1]=function(t){return s.active=!s.active})},Object(c["t"])(n.quest.name),1),Object(c["y"])(Object(c["g"])("div",Pi,[Object(c["g"])("div",Qi,Object(c["t"])(n.quest.data.text),1),Object(c["g"])("div",Gi,Object(c["t"])(n.quest.data.condition),1)],512),[[c["v"],s.active]])])}var Ki={props:["quest"],data:function(){return{active:null}}};n("5234");Ki.render=Wi;var zi=Ki,Ji={components:{SimpleTabs:Vi,QuestItem:zi},inject:["api","apiSubscribe"],data:function(){return{quests:{},types:{active:"Активные",completed:"Завершенные",all:"Все"},activeType:"active"}},computed:{countEachQuestTypes:function(){var t={};for(var e in this.quests)t[e]=this.quests[e].length;return t}},mounted:function(){var t=this;this.api.doAction("getQuests","",(function(e){var n=e.filter((function(t){return 0==t.completed})),c=e.filter((function(t){return 1==t.completed})),i=n.concat(c);t.quests={active:n,completed:c,all:i}}))},methods:{setType:function(t){this.activeType=t}}};n("e170");Ji.render=Fi;var Yi=Ji,Xi=n("262e"),Zi=n("2caf"),ts=(n("ac1f"),n("466d"),"1"),es=function(){function t(e,n){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;Object(ic["a"])(this,t),this.to=e,this.token=n,this.tryConnection=c,this.isReconnect=!1}return Object(sc["a"])(t,[{key:"connect",value:function(){this.tryConnection--&&(this.token.match(/\n/g)?console.log("Invalid token:",this.token):this.server=new WebSocket("".concat(this.to).concat(this.token)))}},{key:"connectViaToken",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,n,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(C+"?id="+(null!==(e=new URL(document.URL).searchParams.get("id"))&&void 0!==e?e:1));case 2:return n=t.sent,t.next=5,n.text();case 5:if(c=t.sent,"error"!==n){t.next=10;break}throw new Error("Session error");case 10:this.token="/"+c,this.connect();case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"send",value:function(t){this.server.send(JSON.stringify(t))}}]),t}(),ns=function(){function t(){Object(ic["a"])(this,t),this.eventHandlers={},this.wsEventHandlers={},this.wsBind(),this.validActions=["sendMessage","chloc","getBackPack","removeItem","wearItem","takeoffItem","getLocMonsters","attackMonster","getEnemy","getFight","hit","talkToNpc","showQuest","questAnswer","takeReward","getQuests"],this.validActions.push("debug","admin_user")}return Object(sc["a"])(t,[{key:"send",value:function(t){this.server.send(t)}},{key:"open",value:function(){"undefined"!==typeof this.wsEventHandlers.open&&this.wsEventHandlers.open.forEach((function(t){return t.cb.call(t.ctx)}))}},{key:"message",value:function(t){switch(t.data){case ts:return void(this.isReconnect?this.isReconnect=!1:this.exit())}var e=JSON.parse(t.data),n=Object.keys(e)[0];"undefined"!==typeof this.eventHandlers[n]&&this.eventHandlers[n].forEach((function(t,c){var i=t.cb,s=t.ctx;t.once;i.call(s,e[n])}))}},{key:"wsBind",value:function(){var t=window.WebSocket,e=this;window.WebSocket=function(n,c){var i=c?new t(n,c):new t(n);return["message","open"].forEach((function(t){return i.addEventListener(t,e[t].bind(e))})),i},window.WebSocket.prototype=t.prototype}},{key:"exit",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t){var e="<h1>обнаружено дублирование окна</h1>";return"prod"==R?_("body").html(e):console.log(e),!0}return!1}},{key:"init",value:function(){this.server=new es("ws://".concat(L,":").concat(A)),this.server.connectViaToken()}},{key:"doAction",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.validActions.includes(t))throw new Error("Invalid action");n&&this.subscribe(t,n,null,!0),this.send(Object(nc["a"])({},t,e))}},{key:"subscribe",value:function(t,e,n){var c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"undefined"===typeof this.eventHandlers[t]&&(this.eventHandlers[t]=[]),this.eventHandlers[t]=[{cb:e,ctx:n,once:c}]}},{key:"unsubscribe",value:function(t){delete this.eventHandlers[t]}},{key:"subscribeToWS",value:function(t,e,n){"undefined"===typeof this.wsEventHandlers[t]&&(this.wsEventHandlers[t]=[]),this.wsEventHandlers[t].push({cb:e,ctx:n})}}]),t}(),cs=function(t){Object(Xi["a"])(n,t);var e=Object(Zi["a"])(n);function n(){return Object(ic["a"])(this,n),e.apply(this,arguments)}return n}(ns),is=Object(c["h"])((function(){return n.e("chunk-d296e478").then(n.bind(null,"dd19"))})),ss=new cs,rs={components:{GameHeader:M,GameFooter:gt,LocationWrapper:Gt,MainModal:bi,UserBackpack:Ye,TheHunting:is,TheDebug:pn,GameFight2:_c,UserSupplies:cn,FightStats:si,NpcView:Mi,QuestList:Yi},data:function(){return{currentMainComponent:"LocationWrapper",apiReady:!1,timer:null,npc:null}},mounted:function(){this.apiReady||ss.init(),this.$store.state.host=new URL(C).origin},provide:function(){return{api:ss,apiSubscribe:this.apiSubscribe,talkToNpc:this.talkToNpc}},methods:Object(b["a"])(Object(b["a"])({},Object(s["c"])(["SET_CSRF","SET_USER","SET_LOCATION","SET_CLOSEST_LOCATIONS","SET_LOCATION_USERS","ADD_LOCATION_USER","REMOVE_LOCATION_USER"])),{},{event:function(t,e){console.log(t,e)},setCurComp:function(t){this.user.fight||(console.log(t),this.npc=null,this.currentMainComponent=t)},changeLocation:function(t){var e=this;this.npc=null,ss.doAction("chloc",t,(function(t){var n=t.trans_time,c=t.trans_timeout;e.$store.commit("SET_TIME",n),e.user.trans_time=n,e.user.trans_timeout=c,e.startTimeTimer()}))},sendMessage:function(t){ss.doAction("sendMessage",t)},scrollDown:function(){messages.scrollTop=messages.scrollHeight},append:function(t){messages.innerHTML+='<div class="msg">\n\t\t\t\t<div class="msg-date">'.concat(date("H:i"),'</div>\n\t\t\t\t<div class="msg-text">').concat(t,"</div>\n\t\t\t</div>")},me:function(t){this.apiReady=!0,this.SET_USER(t),t.fight&&(this.currentMainComponent="GameFight2")},loc:function(t){this.SET_LOCATION(t.loc),this.SET_LOCATION_USERS(t.locUsers),this.SET_CLOSEST_LOCATIONS(t.closestLocs)},addLocUser:function(t){this.ADD_LOCATION_USER(t)},leaveLocUser:function(t){var e=t.id;this.REMOVE_LOCATION_USER(e)},message:function(t){switch(Object(d["a"])(t)){case"string":this.append(t);break;case"object":this.append("".concat(t.from,": ").concat(t.text));break}this.scrollDown()},apiSubscribe:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Array.isArray(t)||(e=t,n=!1,t=Object.keys(t)),t.forEach((function(t){return ss.subscribe(t,e[t],e,n)}))},startTimeTimer:function(){var t=this;clearTimeout(this.timer),this.isWalkingTimeout||(this.timer=setTimeout((function(){t.$store.commit("SET_TIME",t.time+1)}),1e3))},talkToNpc:function(t){var e=this;ss.doAction("talkToNpc",t,(function(t){e.npc=t}))}}),computed:Object(b["a"])(Object(b["a"])({},Object(s["b"])(["user"])),{},{time:function(){return this.$store.state.time},isWalkingTimeout:function(){return!this.user.trans_timeout||this.time>this.user.trans_timeout},currentProps:function(){switch(currentMainComponent){case"LocationWrapper":return 1}return 1}}),watch:{apiReady:function(){}},created:function(){var t=this;this.apiSubscribe(["me","loc","addLocUser","leaveLocUser","message"],this),this.apiSubscribe({time:function(e){t.$store.commit("SET_TIME",e),e<t.user.trans_timeout&&t.startTimeTimer()},error:function(e){return t.$store.commit("SET_MODAL",e)},drop:function(e){return e.forEach((function(e){t.append("<b>".concat(e.npc_name," погиб и что-то выронил. Получено: ").concat(e.name," ").concat(e.count," шт.</b>"))}))}}),ss.subscribeToWS("open",(function(){}),this),this.$store.watch((function(){return t.$store.state.time}),(function(){return t.startTimeTimer()}))}};n("669b");rs.render=l;var as=rs,os=(n("e7eb"),Object(c["c"])(as));os.use(r).mount("#game")},2305:function(t,e,n){"use strict";n("47c2")},"266c":function(t,e,n){"use strict";n("bfa5")},4220:function(t,e,n){"use strict";n("bf9b")},"440a":function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return s}));n("b85c"),n("5530"),n("2909"),n("d81d"),n("a15b"),n("99af"),n("fb6a"),n("ac1f"),n("1276"),n("466d"),n("4d63"),n("25f0"),n("5319"),n("d3b7"),n("b0c0");function c(t){return t>0}function i(t,e){var n=[];for(var c in t)t[c].loc===e&&n.push(t[c]);return n}function s(t,e){t.doAction("getBackPack","",(function(n){e.commit("SET_USER_ITEMS",n),t.doAction("getFight")}))}},"47c2":function(t,e,n){},4997:function(t,e,n){},"4d04":function(t,e,n){},"4f83":function(t,e,n){},5234:function(t,e,n){"use strict";n("4f83")},"5f1f":function(t,e,n){},"669b":function(t,e,n){"use strict";n("e9ce")},7759:function(t,e,n){"use strict";n("4997")},"8e06":function(t,e,n){"use strict";n("e688")},"8ff8":function(t,e,n){},9179:function(t,e,n){},"9ab1":function(t,e,n){"use strict";n("09ef")},"9d7b":function(t,e,n){"use strict";n("edf0")},"9f89":function(t,e,n){},a7f3:function(t,e,n){},a897:function(t,e,n){"use strict";n("0cdb")},ab5c:function(t,e,n){},ac9d:function(t,e,n){"use strict";n("a7f3")},bf9b:function(t,e,n){},bfa5:function(t,e,n){},c1d9:function(t,e,n){"use strict";n("d854")},d307:function(t,e,n){"use strict";n("ab5c")},d854:function(t,e,n){},dee4:function(t,e,n){"use strict";n("8ff8")},dfbc:function(t,e,n){"use strict";n("0af2")},e0b4:function(t,e,n){"use strict";n("9f89")},e170:function(t,e,n){"use strict";n("4d04")},e610:function(t,e,n){"use strict";n("9179")},e688:function(t,e,n){},e7eb:function(t,e,n){},e9ce:function(t,e,n){},edf0:function(t,e,n){}});
//# sourceMappingURL=index.7682519b.js.map